\section*{Решения и комментарии}

\subsubsection*{Подмножества подмножеств}% (Subsets of subsets)

Хитрость в данной задаче, основанной на одном из заданий Международной Математической Олимпиады 1972 года, заключается в том, что в начале условие непересечения подмножеств игнорируется и рассматриваются все подмножества.
Множество $S$ из 10 элементов содержит, разумеется, $2^{10} - 1 = 1023$ непустых подмножества.
Могут ли суммы чисел этих подмножеств все быть различны?
Максимальная сумма подмножества множества из десяти чисел от 1 до 100 будет 
$100+99+...+91<1000$, а минимальная, очевидно, больше 1; таким образом, согласно принципу Дирихле, должны существовать два различных подмножества $A\subset S$ и $B\subset S$ 
с одинаковой суммой.
Конечно, $A$ и $B$ могут пересекаться, но можно просто выбросить общие элементы;
$A\backslash B$ (множество элементов $A$, не содержащихся в $B$) и $B\backslash A$ \emph{не} пересекаются и по-прежнему имеют одинаковую сумму.\heart

\subsubsection*{Вредный метрдотель}% (The Malicious Maitr D’)

Появление данной задачи можно отнести к определённому событию.
Принстонский математик Джон Хортон Конвeй %(John H. Conway) 
прибыл 30-го марта 2001 года в лаборатории Белла %(Bell Labs) 
чтобы сделать доклад на «Общенаучном семинаре». %(“General Research Colloquium”).
На обеде, ваш автор оказался сидящим за столом между Конвейем и специалистом по компьютерным технологиям Робом Пайком %(Rob Pike) 
(сейчас работает в Гугле), и салфетки, и кофейные чашки были расставлены точно также, как описано в задаче.
Конвей задался вопросом, а сколько человек из
сидящих за столом остались бы без салфеток, если бы их рассаживали в случайном порядке (см. Главу 11), а Пайк сказал: «А вот более лёгкий вариант: а какой порядок самый плохой?»

\bigskip

Допустим, что метрдотель, когда сажает человека на место, видит, которую салфетку взяли (такого игрока называют «адаптивным противником»). %(“adaptive adversary”) 
Тогда лучшая для него стратегия состоит в следующем.
Если первый гость возьмёт салфетку, скажем, справа от себя, то следующий будет посажен на второе место справа, так что тот, кто окажется между ними, может попасть в западню.
Если второй человек берёт салфетку справа, метрдотель пытается делать то же самое и дальше, пропуская место справа.
Если же второй человек возьмёт салфетку слева (оставляя таким образом место между ним и первым посаженным без салфеток), третий сажается сразу справа от второго.
Далее гостям указываются места соответственно этому правилу, пока круг не замкнётся, и тогда последние обедающие (обречённые остаться без салфеток) садятся за стол.
В результате, в среднем, $1/6$ часть гостей остаётся без салфеток.

Когда же, как в поставленной задаче, метрдотель не «адаптивный противник», то, как показалось Пайку и мне, правильной стратегией было бы заполнить сначала все чётные, а затем нечётные места.
Для каждого нечётного гостя вероятность остаться без салфетки будет равна $1/4$, %(for an overall yield) 
а конечным результатом будет $1/4$ (6 из 48 обедающих, в среднем).

Хотя, если подумать ещё немного, то наилучшая стратегия для метрдотеля --- заполнить сначала места с номерами 0mod4, затем нечётные места, и, наконец места $2\pmod4$.
Это расстроит 9/64 гостей, в среднем.
Чтобы понять это, назовём гостя «одиноким», если, когда он посажен на место, у него ещё нет соседа ни справа, ни слева.
Можно предположить, что все «одинокие» гости рассаживаются первыми, и заметим, что между каждой сидящей подряд парой «одиноких» будет максимум один бессалфеточный гость.

Допустим, два последовательно сидящих «одиноких» гостя находятся на расстоянии $d$ друг от друга (то есть между ними $d-1$ стульев).
Эти места будут заполняться с обеих сторон; предположим, последний садящийся между ними человек находится на расстоянии $a$ от правого и на расстоянии $b$ от левого «одинокого» гостя, где $a+b=d$.
Правая салфетка будет уже взята, если только «одинокий» обедающий не сидит сразу справа от него, и все последующие гости между парой «одиноких» не выбрали левые салфетки.
Это случается с вероятностью $1/2^a$.
Таким образом, оказавшийся в ловушке 
гость проигрывает (остаётся без салфетки) с вероятностью
\[(1-2^{-a})(1-2^{-b})=1 + 2^{-d}-2^{-a}-2^{-b},\]
которая минимальна, когда $a$ и $b$ равны или отличаются на 1.

Если «одинокие» гости рассажены на расстоянии $d$ друг от друга, то мы получаем одного потенциального проигравшего на $d$ человек.
Таким образом, если число гостей $n$ кратно $d$, то среднее число проигравших равно $(n/d)(1-2^{-\lfloor d/2\rfloor})(1-2^{-\lceil d/2\rceil})$.
Легко проверить, что эта величина достигает максимума не при $d=2$, где она будет равна $n/8$, а при $d=4$, мы получаем $9n/64$.\heart

\subsubsection*{Рукопожатия на приёме}% (Handshakes at a Party)

Данная задача основана на старом избитом трюке, что нам, на первый взгляд, предоставляется недостаточное количество информации.
С чего, казалось бы, мы можем делать какие-либо заключения о \emph{Жанне}?
Ответом, в конечном итоге, является тот факт, что Жанна не принимала участия в опросе.

Так как для каждого гостя максимальное количество рукопожатий будет равно 8, 
девять ответов, полученных Майком, --- это как раз числа от 0 до 8.
Два человека (скажем, $A$ и $B$), ответившие 0 и 8, должны быть парой, ведь в противном случае наличие и отсутствие рукопожатия между ними противоречило бы одному из их ответов.
Теперь проверим $C$ и $D$, которым соответствуют 1 и 7;
поскольку $C$ должен был пожать руки с $B$, а $D$ должен был пропустить $A$, то, применяя рассуждение выше, получаем, что $C$ и $D$ так же являются парой.

Аналогично, гости, ответившие 2 и 6, 3 и 5 также должны быть парами.
Это заставляет Майка и Жанну пожать руки гостя, имеющим наибольшие результаты опроса, и значит каждый из них пожал руку четырём.
\heart

Если вы не представляли себе доказательства, но догадались, что ответ будет 4, ваша интуиция на правильном пути.
Если предположить что задача имеет единственный ответ (скажем $x$), то в силу симметрии $x=4$.
Предположим (по какой-то причине) каждая пара пожала руки друг-другу и Майк спросил каждого скольким гостям тот \emph{не} пожал руку.
Тогда Женни должна была пожать $x+1$ рук.
Но меняя местами роль рукопожатий и нерукопожатий говорит, влечёт, что $x+(x+1)=9$.

%(???

Рассуждения на основе того, что головоломка имеет единственное решение часто оказывается полезным.
В одной из своих «Математических игр» для \emph{Scientific American}, Мартин Грднер спросил:
Предположим дырка в 6 дюймов длиной просверленна через центр шара, чему равен оставшийса объём?

Может показаться, что для решения задачи необходимо знать диаметр дырки, или диаметр исходного шара, но на самом деле этого не нужно.
Чем больше шар тем шире должна быть дырка для того чтобы иметь длину 6 дюймов;
при этом вычисления показывают, что объём оставшегося кольца не не меняется.

Однако нет необходимости делать эти вычисления если поверить, что решение единственно.
Ответ должен быть то же для шара с 6 дюймами в диаметре и без дырки, а именно $\tfrac43\pi3^3=36\pi$ кубических дюймов.

%???)

\subsubsection*{Трёхсторонние выборы}% (Three-Way Election)

Бакстер прав, более того, он недооценивает ситуацию.
Представим себе, что никто из голосующих не изменяет своего выбора, тогда несомненно выигрывает Ашворд!
Предположим, что избиратели, голосовавшие за Ашворда, предпочитают Бакстера Кэмпбеллу (то есть Бакстер выиграет у Кэмпбелла в предложенных двухсторонних выборах).
Тогда избиратели, голосовавшие за Бакстера, должны предпочитать
Кэмпбелла Ашворду, иначе Кэмпбелл не набрал бы 1/3 голосов второго выбора.
Аналогично, избиратели, голосовавшие за Кэмпбелла, предпочитают Ашворда
Бакстеру.
Таким образом, в нашем случае, Ашворд побеждает Бакстера во втором
голосовании.

Если же избиратели, голосовавшие за Ашворда, предпочитают Кэмпбелла Бакстеру, симметричное рассуждение приводит нас к тому же результату --- во втором голосовании побеждает Ашворд.
\heart

Эта задача, придуманная математиком Эхудом Фридгутом %(Ehud Friedgut)
для классной работы, говори, что разрешение ничьи не так уж просто, как кажется на первый взгляд!% (что разрешению ничьи присуще гораздо большее, чем представляется на первый взгляд) %??? раздел на два предл.

\subsubsection*{Зарплата короля}% (King’s Salary)

Данная задача придумана Йоханом Вестлундом %(Johan Waestlund) 
из Линчёпингского университета, а идея её была навеяна историческими событиями в Швеции.
Тут нужно сделать два важных замечания: (1) король должен временно отдать свою зарплату, чтобы начать эту игру, и (2) на каждом шаге мы должны уменьшать количество жителей, получающих зарплату.

Король начинает с того, что предлагает удвоить зарплату 33 жителям (они получат по 2 доллара) за счёт остальных 33 граждан, включая его самого.
Затем, он увеличивает зарплату 17 из 33 оплачиваемых жителей (они получат по 3 или 4 доллара), а оставшиеся 16 останутся в нулях.
На каждом последующем шаге количество голосующих граждан сводится к 9, 5, 3 и 2.
В конце концов, король подкупает 3 бедняков зарплатой в 1 доллар каждому, для того, чтобы они помогли ему перевести две большие зарплаты на него самого, и, таким образом, завершает игру с королевской зарплатой в 63 доллара.

Нетрудно заметить, что король на каждом этапе не может предпринять ничего лучшего, как уменьшать количество людей с зарплатой до чуть больше половины, в частности, он никогда не сможет дойти до единственного человека с зарплатой.
Стало быть, 63 доллара --- это лучшее, что он может для себя сделать, и 6 шагов --- оптимальное решение.
\heart

В более общем случае, если начальное количество жителей равно $n$, король может добиться зарплаты в $n-3$ доллара за $k$ шагов, где $k$ --- наименьшее целое число большее или равное $\log_2(n-2)$.

\subsubsection*{Плохо сделанные часы}% (A Poorly Designed Clock)

Энди Латто %(Andy Latto, 
(andy.latto@pobox.com), инженер-программист из Бостона, представил эту прелестную задачу в Атланте, на конференции «Gathering for Gardner IV», одной из серии конференций в честь Мартина Гарднера.
При достаточном количестве терпения и внимательности задачу можно решить алгебраическим или геометрическим способом, но существует замечательное доказательство %???(irresistible proof)
без карандаша и бумаги, предложенное Майклом Ларсеном, %(Michael Larsen)
профессором математики из университета Индианы.
Идею третьей стрелки (вместо вторых часов) подсказал мне Дэвид Гейл. %(David Gale)

Для начала отметим, для того, чтобы эта задача имела какой-либо смысл, мы должны положить, что стрелки движутся непрерывно, и что мы не заботимся о том, утро это или вечер.
Обратим также внимание, что мы можем сказать, сколько времени, когда стрелки совпадают, даже если мы не знаем, какая стрелка какая.
Это случается 22 раза в день, так как за день минутная стрелка делает полный оборот 24 раза, а часовая --- 2 раза, в том же направлении.

Это наблюдение послужит нам в дальнейшем доказательстве.
Представим, что мы добавляем к нашим часам третью, «быструю» стрелку, которая начинает ходить в 12 часов полуночи и ровно в 12 раз быстрее, чем минутная стрелка.

Итак, мы теперь будем говорить, что каждый раз, когда часовая и быстрая стрелка совпадают, они находятся в неопределённом положении.
Почему?
Потому что позже, когда минутная стрелка пройдёт в 12 раз больше, она окажется там, где быстрая стрелка (а, следовательно, и часовая) находятся в данный момент.
По тем же соображениям верно и обратное утверждение: все неопределённые положения случаются тогда, когда часовая и быстрая стрелка совпадают.

Нам остаётся только вычислить, сколько таких совпадений происходит за один день.
Быстрая стрелка делает $12^2\times 2 = 288$ оборотов в день, а часовая только два, таким образом случается 286 совпадений.
Из них 22 раза совпадают минутная и часовая стрелки (то есть все 3 стрелки), оставляя нам, таким образом, 264 неопределённых момента.
\heart

\subsubsection*{Таинственный карточный фокус}% (A Mystifying Card Trick ) 

Данный карточный фокус обычно приписывается математику Уильяму Фитч Чейни. % (William Fitch Cheney).
Более подробную информацию читатели могут найти в статье Майкла Клебера (Michael Kleber) в журнале «The Mathematical Intelligencer» т. 24, №1 (зима 2002);
или в статье Колма Малкэхи (Colm Mulkahy) в журнале Математической Ассоциации Америки (The Mathematical Association of America) «Mathematical Horizons», 2003 года, в которой обсуждаются различные варианты этого фокуса.%???refs ???

Итак, Дороти сообщает Давиду информацию только через порядок четырёх карт, которые она ему передаёт.
Конечно, у нас только 4!=24 возможных перестановок на 48 вариантов для пятой карты, хитрость в том, что Дороти решает, какую из пяти карт выбрать.

Самый простой способ для Дороти, который я знаю, --- это выбрать карту той масти, которая представлена хотя бы дважды (опять принцип Дирихле!).
Предположим, что это пики, обозначим карты $x$ и $y$ (будем думать о них как о числах между Тузом $= 1$ и Королём $= 13$, по модулю 13).
В одну сторону или в другую карты отстоят друг от друга не более чем на 6;
допустим, что $x$ «больше», так что $x-y\in {1,2,3,4,5,6} \pmod{13}$.
Таким образом, например, у нас может быть $x =3\equiv 16$ и $y = 12$ (Дама пик), так что $x - y = 4$.

Дороти выбирает $x$, $y$ ставит первой из оставшихся четырёх карт и тремя другими картами кодирует разность $x - y$.
Например, представим, что Дороти и Давид договорились о следующем порядке колоды: 
\[\clubsuit \text{Т}, \clubsuit 2,\dots \clubsuit \text{К}, \Diamond \text{Т},\dots, \Diamond \text{К}, \heartsuit \text{Т}, \dots, \heartsuit \text{К}, \spadesuit  \text{Т}, \dots, \spadesuit \text{К}.\]
Если карты стоят по возрастанию (скажем, $\clubsuit 5, \clubsuit \text{В}, \Diamond 3$), то $x - y = 1$; обозначим этот порядок $123$.
Положим $x - y = 2$ для порядка 132,
$x - y = 3$ для 213, $x - y = 4$ для 231, $x - y = 5$ для 312 и, наконец, $x - y = 6$ для 321.

Конечно, нужно немного потренироваться, чтобы показывать этот фокус безупречно.

\medskip

Обратите внимание на слабое место в этой схеме: если среди пяти карт, полученных Дороти, мастей представлено меньше четырёх, она имеет, по меньшей мере, два варианта выбора карты.
Естественно будет задаться вопросом: насколько больше может быть колода карт, чтобы всё ещё можно было исполнить фокус;
максимум оказывается равным 124.

Покажем, что лучше сделать невозможно.
Представим, что карты пронумерованы от 1 до $n$ и рассмотрим функцию $f$, которая каждой упорядоченной четвёрке $(u,v,y,z)$ с попарно различными элементами сопоставляет пятую карту $x$, ту, которую Давид должен определить, глядя на эту четвёрку.
Чтобы фокус получился, Дороти должна уметь, имея
любое множество S из пяти элементов в ${1, \dots, n}$, выбрать четыре элемента $(u,v,y,z)$ так, что $S = {u,v,y,z, f(u,v,y,z)}$.
Таким образом, число всех четвёрок должно по меньшей мере быть равно числу всех множеств из пяти элементов, т.е.
\[n(n - 1)(n - 2)(n - 3)\ge \binom n5,\]
что влечёт $n - 4 \le5!$, $n\le 124$.


Исполнить фокус с картами, пронумерованными от 1 до 124, удивительным легко.
Вот способ, предложенный мне Элвином Берлекэмпом.
%(Elwyn Berlekamp).
Допустим, выбранные карты $c_1 < c_2 < \dots < c_5$;
Дороти берёт карту $c_j$, где $j$ --- сумма значений всех пяти карт по модулю 5.
Глядя на оставшиеся четыре карты, сумма которых равна, скажем, $s$ по модулю 5, Давид должен найти число $x$ такое, что $x\equiv -s + k \pmod 5$, если $x$ есть $c_k$.

Другими словами, либо $x$ --- меньше, чем любая из карт Давида и удовлетворяет 
$x\equiv-s + 1 \pmod 5$; либо $x$ больше наименьшей карты, но меньше следующей за ней, и 
$x\equiv -s + 2 \pmod 5$; и так далее.
Но это всё равно, что сказать, что $x\equiv -s + 1 \pmod 5$,
если оставшиеся 120 карт перенумерованы подряд от 1 до 120,
пропуская четыре карты в руках у Давида.

Так как только ровно $120/5 = 24 = 4!$ числа из чисел от 1 до 120 имеют данное значение по модулю 5, мы можем, переставляя четыре карты Давида, закодировать возможные значения $x$.\heart

\subsubsection*{Странствующие торговцы} %(Travelling Salesmen )

Данная задача, представленная на 11-й Всесоюзной Математической Олимпиаде в Таллине в 1977 году, неприятно %(annoyingly tricky) 
сложная.
Очевидно, Лавиш тратит по меньшей мере столько же денег, сколько и Фругаль!
Но как это доказать? %???посмотреть на формулировку 

Кажется, что наилучшим доказательством было бы показать, что для любого $k$ $k$-тый самый дешёвый перелёт (обозначим его $f$) Лавиша стоит, по меньшей мере, столько же, сколько $k$-тый самый дешёвый рейс Фругаля.
Это утверждение представляется более сильным чем то, что требуется доказать, но на самом деле вовсе не так.
Если бы существовал контрпример, то мы могли бы подправить стоимость перелётов, не меняя их порядка, таким образом, что Лавиш потратил бы меньше, чем Фругаль.

Для удобства представим, что Лавиш посещает города по порядку с запада на восток.
Пусть $F$ --- множество из $k$ самых дешёвых перелётов Лавиша, $X$ --- множество городов вылета, и $Y$ --- городов прилёта.
Заметим, что $X$ и $Y$ могут перекрываться.

Будем называть перелёт «дешёвым», если он стоит не больше перелёта $f$.
Мы хотим показать, что у Фругаля, по меньшей мере, $k$ дешёвых перелётов.
Обратите внимание, что все перелёты на восток в города из множества $X$ дешёвые; в противном случае этим рейсом летел бы Лавиш вместо того дешёвого перелёта из множества $F$, который он собственно и купил.

Назовём город «хорошим», если Фругаль улетает из него дешёвым рейсом, и «плохим» в обратном случае.
Если все города множества $X$ --- хорошие, задача решена: рейсы Фругаля из этих городов и составят $k$ дешёвых перелётов.
В противном случае, пусть $x$ будет самым западным плохим городом в множестве $X$, тогда, когда Фругаль попадает в $x$, он уже побывал в каждом городе к востоку от $x$, иначе бы Фругаль улетал бы из $x$ дешёвым рейсом.
Но тогда в каждом городе к востоку от $x$, когда его посещал Фругаль, был доступен самый дешёвый перелёт в $x$, то есть все эти города хорошие.
В частности, все города множества $Y$ к востоку от $x$ хорошие, так же как и все города множества $X$ к западу от $x$; что вместе даёт $k$ хороших городов.
\heart

Хочу поблагодарить Брюса Шепперда %(Bruce Shepperd) 
из лабораторий Белла %(Bell Labs) 
за помощь в нахождении вышеприведённого решения.
Мы не знаем, какое решение предполагалось автором задачи.

\subsubsection*{Проигрыш в кости}% (Losing at Dice)

Конечно же, здесь есть подвох.
В среднем вам потребуется вечность, чтобы полностью проиграться --- шансы на вашей стороне! 
Я обратил внимание на этот контринтуитивный факт много лет назад, когда составлял домашнее задание для курса элементарной теории вероятности в Университете Эмори.

При бросании кубиков мы имеем $6^6 =46656$ возможных наборов цифр.
Четыре различные цифры выпадают, в одном из двух наборов AABBCD и AAABCD.
Есть
\[\binom62\cdot\binom42/2=45\]
вариантов первого набора, где парные и одиночные цифры располагаются в алфавитном порядке, например, AABBCD, ABABCD, ACDABB, но не BBAACD или AABBDC.

У второго набора $\binom63=20$  вариантов.
Существует $6\cdot 5\cdot 4\cdot 3=360$ способов присвоения цифрам буквенных значений, что даёт в сумме $360\cdot 65=23400$ вариантов.
Таким образом, вероятность выигрыша
$23400/46656 = 50.154321\%$.
\heart

Если вы поставите и выиграете в эту игру, не забудьте послать 5\% от прибыли мне 
(Peter Winkler, ${^c\!/\!_o}$ A  K Peters).
