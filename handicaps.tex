\chapter*{Алгоритмы с препятствиями}
\addcontentsline{toc}{chapter}{Алгоритмы с препятствиями}

\setlength{\epigraphwidth}{.85\textwidth}
\epigraph{У кислоты есть три побочных эффекта: усиление долговременной памяти, ослабление кратковременной, а третий я забыл.}{---Тимоти Лири (1920--1996)}

Известный анекдот про Флориду.
Два старичка (старых гриба), Сэм и Тед, сидят на крыльце у Сэма и болтают.
--- Это ужасно, --- говорит Тед, --- последнее время у меня совсем плохо с короткой памятью.
Каждый день я с трудом вспоминаю, принимал ли я мои таблетки или нет.

--- Я знаю, о чём ты говоришь, --- отвечает Сэм.
--- Мой доктор нашёл решение этой проблемы --- он добавил специальную таблетку памяти к моим ежедневным лекарствам, и теперь у меня всё отлично!

--- Ты шутишь! Как называются эти таблетки? Может, и мне такие пропишут?

--- Хм-м, хороший вопрос.
Дай подумать, ... ум-м ... быстро, скажи название растения.

--- Растения? Ты имеешь ввиду куст или дерево?

--- Нет, поменьше такое, декоративное...

--- Цветок?

--- Да, бывает красный ...

--- Гвоздика? Тюльпан?

--- Нет, такой, с шипами ...

--- Роза?

--- Точно! Она! --- Сэм поворачивается и кричит в открытую дверь, --- Роза! Как называются мои таблетки для памяти?

\medskip

Алгоритмические задачи могут накладывать странные ограничения, часто связанные с памятью.
Требуется достаточно много воображения, чтобы разобраться с такими задачами, и найти решение, которое сможет применить человек менее способный, чем вы.
Задачу подобного сорта, которую мы рассмотрим в качестве примера, можно оценить как вполне реалистичную.

\subsection*{Нахождение числа}% (FINDING THE MISSING NUMBER)

Вам прочитывают все числа от 1 до 100, кроме одного.
Каждые 10 секунд называется одно число, в произвольном порядке.
Вы хорошо соображаете, но обладаете обычной памятью, и у вас нет возможности делать записи во время чтения.
Каким образом вы можете гарантировать, что после прочтения вы определите неназванное число ?

\paragraph{Решение:} Легко --- вы складываете называемые числа, добавляя к общей сумме на каждом шаге.
Сумма \emph{всех} чисел от 1 до 100 --- это 100, помноженное на их среднее ($50\tfrac12$), а именно 5050.
Вычитая отсюда полученную вами сумму, получаем пропущенное число.

И нет необходимости держать в уме сотни или тысячи во время суммирования, достаточно складывать по модулю 100.
В конце вы вычитаете полученный результат из 50 или 150, чтобы получить ответ в правильном диапазоне.
\heart

Обработка потока информации при ограниченных возможностях вычисления и сохранения памяти является очень серьёзной проблемой.
Ваша первая задача схожа с нашим примером, а возникла она как серьёзная проблема в теории вычислений.

\subsection*{Определение большинства}% (IDENTIFYING THE MAJORITY)

Читается длинный список имён, некоторые имена повторяются много раз.
Ваша цель --- найти имя, которое гарантированно называлось наибольшее число раз, если такое существует.

Но, у вас имеется только один счётчик, плюс, вы можете держать в уме только одно имя за раз.
Возможно ли это сделать?

Следующая задача пришла ко мне от Джона Конвея, профессора Принстонского университета (наряду со \emph{многими} друми достижениями, автора игры «Жизнь»).
Говорят, что одна несчастная жертва, которой попалась эта головоломка, просидела без движения на стуле шесть часов.

\subsection*{Обездвиживатель конвея}% (THE CONWAY IMMOBILIZER)

Три карты, Туз, Король и Дама, выкладываются в открытую на стол в несколько или в одну из отмеченных колод («левая», «средняя», «правая»).
Если они все кладутся в одну колоду, вы видите только верхнюю карту, если они разложены на две колоды, вы видите две карты, но не знаете, под которой из двух спрятана третья.

Ваша задача --- сложить все карты в в левую колоду в следующем порядке: сверху Туз, потом Король и внизу Дама.
Вы можете перекладывать по одной карте за ход, снимая только верхнюю карту с одной колоды и помещая её на верх другой (возможно пустой).

Проблема в том, что у вас нет кратковременной памяти, и вам необходимо придумать некий алгоритм, в котором каждый ход основывается только на том, что вы видите в данный момент, а не на том, что вы видели и делали перед этим, или сколько произошло ходов.
Наблюдатель скажет вам, когда вы выиграли.
Возможно ли придумать алгоритм, приводящий к выигрышу за ограниченное число шагов, вне зависимости от начальной раскладки карт?

\medskip

Две из оставшихся четырёх головоломок о выключателях --- очень полезных приспособлений для придумывания головоломок.
Последняя полушутошная задача напомнит об анекдоте в начале главы.

\subsection*{Крутящиеся выключатели}% (SPINNING SWITCHERS)

К лампочке последовательно подключены четыре одинаковых, непомеченных выключателя.
Эти выключатели --- простые кнопки, по виду которых невозможно определить, в каком они находятся состоянии.
Но состояние можно поменять, нажав на кнопку.
Выключатели установлены в углах вращающегося квадрата.
За один раз вы можете одновременно нажать любое количество кнопок, а затем ваш оппонент (противник) крутит квадрат.
Докажите, что существует детерменистический %(determenistic) 
алгоритм, который позволит вам включить лампочку за не более чем фиксированное число шагов.

\subsection*{Комната с одной лампочкой}% (THE ONE-BULB ROOM)

Каждого из $n$ заключённых посылают в некую комнату бесконечно часто, но в порядке, определяемом тюремщиком.
У заключённых есть возможность договориться заранее, но как только начинаются посещения комнаты, у них остаётся единственный способ общения --- включать или выключать в комнате лампочку.
Помогите создать протокол, который в итоге позволит \emph{кому-то} из заключённых определить, что каждый из них побывал в комнате.

\subsection*{Два шерифа}% (ТHE TWO SHERIFFS)

Шерифы двух соседних городков ищут убийцу, в деле имеется восемь подозреваемых.
Опираясь на независимые достоверные оперативные источники, каждый шериф сузил свой список подозреваемых до двух человек.
И теперь они ведут телефонный разговор, его цель --- сравнить информацию, и если их пары подозреваемых имеют одно пересечение, арестовать убийцу.

Проблема в том, что их телефон прослушивается местной бандой линчевателей, которым известен начальный список подозреваемых, но к каким парам сошлись шерифы, они не знают.
Если в результате этого звонка линчеватели смогут точно определить, кто убийца, его линчуют прежде, чем смогут арестовать.

Могут ли шерифы, которые раньше никогда не встречались, вести разговор таким способом, чтобы по его окончанию они оба знали, кто убийца (если возможно), но при этом банда линчевателей осталась бы в неведении?

\subsection*{Рассеянный профессор}% (THE ABSENT-MINDED PILL TAKER)

Рассеянный профессор математики должен каждый день принимать таблетку, но у него проблема с кратковременной памятью, и он никогда не помнит, принимал ли он в этот день таблетку или нет.
Чтобы помочь себе, он купил специальную коробочку с семью прозрачными ячейками, помеченными \textsc{вс}, \textsc{пн}, \textsc{вт}, \textsc{ср}, \textsc{чт}, \textsc{пт}, \textsc{сб}.
К счастью, так как он читает лекции, он всегда знает, какой сегодня день недели.

Проблема в том, что он получает новую упаковку с 30 или около того таблетками, как только он заканчивает старые, и это может случиться в любой день недели.
Он хотел бы сразу сложить все таблетки в коробочку, но потом он не помнит, сколько таблеток было в упаковке, или в какой день недели он получил новые таблетки.

Кажущийся очевидным способ раскладывать таблетки по одной за раз, начиная с текущего дня, не работал, потому что наступал момент, когда в каждой ячейке было одинаковое число таблеток, и профессор не мог понять, принимал ли он в этот день таблетку или нет.
Профессор пытался класть \emph{все} таблетки в одну ячейку текущего дня, а затем перекладывал их все вправо каждый раз, когда пил таблетку.
Но проблема была в том, что он забывал иногда их перекладывать!

Можно ли предоставить профессору алгоритм, который будет говорить ему, опираясь только на день недели и то, что профессор видит в коробочке, должен ли он принять таблетку или нет, и если да, то из какой ячейки? Алгоритм должен сказать профессору, как надо раскладывать таблетки, когда он их получает, и давать свободу позже перекладывать любое их количество.
